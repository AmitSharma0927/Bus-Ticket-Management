#include<stdio.h>
#include<conio.h>
#include<string.h>
struct bus
{
    int busnumber;
    char buscode[20];
    //char seat[8][4][20];
    char driver_name[20];
    char goes_to[20];
    char goes_from[20];
    //int ticket_sold;
};

void main()
{

    int busnumber;
    char buscode[20];
//    char seat[8][4][20];
    char driver_name[20];
    char goes_to[20];
    char goes_from[20];
  //  int ticket_sold;
    int choice;
 //   int size=sizeof(struct bus);
   //	int choice=1;
 //	int bus_count=1;
	//struct item list_of_items[3];
	int i;

    clrscr();

    do
    {
	printf("\n	         *************************************************           ");
	printf("\n	                 WELCOME TO BUS RESERVATION SYSTEM :	             ");
	printf("\n	         *************************************************           ");
	printf("\n 0.Exit ");
	printf("\n 1.Install bus record ");
	printf("\n 2.Update bus record ");
	printf("\n 3.Delete bus record ");
	printf("\n 4.Show buses available ");
	printf("\n 5.Show bus details with routes and timings ");
	printf("\n 6.Apply for reservation ");
	printf("\n 7.Generate bill ");
	printf("\n 8.Pay amount ");

	printf("\n Enter your choice : ");
	scanf("%d",&choice);
	printf("\n ********************");
	switch(choice)
	{
	    case 1:
		install_bus_record();

	    break;

	    case 2:
	    break;

	    case 3:
	    break;

	    case 4:
 //		count_items_in_file();
	    break;

	    case 5:
		show_bus_details_with_routes_and_timings();
	    break;

	    case 6:
	    break;
	}
	printf("\n Press enter to continue...");
	getch();
}while(choice!=0);
getch();
}

void install_bus_record()
{
 //	int size=sizeof(struct bus);
	FILE *fp1=fopen("bus.dat","a");

	struct bus detail;
	//FILE *fp=fopen("bus.dat","a");
	printf("\n Enter the bus number :");
	fflush(stdin);
	scanf("%d",&detail.busnumber);
	printf("\n Enter the bus code number : ");
	fflush(stdin);
	gets(detail.buscode);
	printf("\n Enter the driver's name:");
	fflush(stdin);
	gets(detail.driver_name);
	printf("\n Enter the location from which bus goes :");
	fflush(stdin);
	gets(detail.goes_from);
	printf("\n Enter the location to which bus goes :");
	fflush(stdin);
	gets(detail.goes_to);

	fwrite(&detail,sizeof(struct bus),1,fp1);
	printf("\n **********************************");
	printf("Details added in successfully..................");
	getch();

	fclose(fp1);
}

/*int bus count()
{
    int count=0;
    FILE *fp=fopen("bus.dat","r");
	struct bus detail;
	while(!feof(fp))
    {
	fread(&detail,sizeof(struct bus),1,fp);
	count++;
    }
    return count;
}*/

/*
int return_items_in_file()
{
	int count=0;
 //	int size=sizeof(struct bus);
	struct bus detail;

	FILE *fp1=fopen("bus.dat","r");

	while(!feof(fp1))
	{
		fread(&detail,size,1,fp1);
		count++;
	}
	fclose(fp1);
	return count-1;
}


void count_items_in_file()
{
	int count=0;
	int size=sizeof(struct bus);
	struct bus detail;

	FILE *fp1=fopen("bus.dat","r");

	while(!feof(fp1))
    {
	fread(&detail,size,1,fp1);
	count++;
    }
	count--;
	fclose(fp1);
	printf("\n Number of details of buses in file=%d",count);
} */

void show_bus_details_with_routes_and_timings()
{
	int i;
 //	int size=sizeof(struct bus);
   // int n=bus_count();
    //	int bus_count=return_items_in_file();
       //	struct bus detail;

	FILE *fp1=fopen("bus.dat","r");
		struct bus detail;

	printf("\n *********************************");
	printf("\n File content is : ");
	printf("\n *********************************");

      //	for(i=0;i<bus_count;i++)

	printf("\n ");
	fread(&detail,sizeof(struct bus),1,fp1);
	printf("\n %d %s %s %s %s",detail.busnumber,detail.buscode,detail.goes_from,detail.goes_to,detail.driver_name);
}
